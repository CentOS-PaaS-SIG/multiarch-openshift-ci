library identifier: "multiarch-openshift-ci@trigger-test",
        retriever: modernSCM([$class: 'GitSCMSource', remote: "https://github.com/detiber/multiarch-openshift-ci"])

node("paas-sig-ci-slave01") {
  ansiColor('xterm') {
    timestamps {
      stage('init') {
        checkout(
          changelog: true,
          poll: true,
          scm: [
            $class: 'GitSCM',
            branches: [
              [name: 'origin/master']
            ],
            doGenerateSubmoduleConfigurations: false,
            browser: [
              $class: 'GithubWeb',
              repoUrl: 'https://github.com/openshift/origin'
            ],
            extensions: [
              [$class: 'CleanBeforeCheckout'],
              [$class: 'RelativeTargetDirectory', relativeTargetDir: 'origin']
            ],
            gitTool: 'Default',
            submoduleCfg: [],
            userRemoteConfigs: [
              [
                name: 'origin',
                refspec: '+refs/heads/master:refs/remotes/origin/master',
                url: 'https://github.com/openshift/origin.git'
              ],
              [
                name: 'detiber',
                refspec: '+refs/heads/multiarch:refs/remotes/detiber/multiarch',
                url: 'https://github.com/detiber/origin.git'
              ]
            ]
          ]
        )
        sh('''#!/usr/bin/bash -xeu
              pushd origin
              git merge detiber/multiarch
              popd
           ''')
      }

      stage('do something'){
        def arches=['x86_64', 'aarch64', 'ppc64le', 's390x']
        withArches(
          arches,
          {
            echo 'do something'
          }
        )
      }
      stage('post') {
        task 'hi'
        echo 'hi'
        task 'bye'
        echo 'bye'
      }
    }
  }
}
